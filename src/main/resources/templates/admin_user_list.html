<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用户列表</title>
    <script src="../../webapp/js/vue.min.js" th:src="@{/js/vue.min.js}"></script>
    <script src="../../webapp/js/jquery.min.js" th:src="@{/js/jquery.min.js}"></script>
    <script src="../../webapp/js/axios.min.js" th:src="@{/js/axios.min.js}"></script>
</head>
<style>
    table{
        min-width: 600px;
    }
    table tr{
        line-height: 30px;
    }
    table tr td{
        padding-left: 5px;
    }
    a.disableHref{
        cursor: default;
        color: gray;
    }
    a.disableHref:hover{
        color: gray;
    }
    a:hover{
        color: cadetblue;
    }
    .nav_top a{
        display: inline-block;
        margin-left: 3px;
        margin-right: 3px;
    }
</style>
<body>
    <div id="admin_app" style="width: 100%;">
        <div style=" margin: 20px auto;width: 300px;" class="nav_top">
            <a href="#">用户</a>
            <a href="#">老师</a>
            <a href="#">学员</a>
            <a href="#">校区</a>
            <a href="#">班级</a>
            <a href="#">商品</a>
            <a href="#">订单</a>
        </div>
        <div>
            <table align="center" border="1px" width="60%">
                <tr>
                    <td>编号</td>
                    <td>用户名</td>
                    <td>密码</td>
                    <td>权限</td>
                    <td>编辑</td>
                    <td>删除</td>
                </tr>
                <tr v-for="u in users">
                    <td>{{u.id}}</td>
                    <td>{{u.name}}</td>
                    <td>{{u.password}}</td>
                    <td>{{u.actor}}</td>
                    <td><a :href="'editUser?id=' + u.id">编辑</a></td>
                    <td><a href="#">删除</a></td>
                </tr>
                <tr align="center">
                    <td colspan="6">
                        <a href="#" :class="{disableHref:pagination.pageNum==pagination.firstPage}" @click="jump('first')">[ 首 页 ]</a>
                        <a href="#" :class="{disableHref:!pagination.hasPreviousPage}" @click="jump('pre')">[ 上一页 ]</a>
                        [
                        <a href="#" :class="{disableHref:pagination.pageNum==i}" v-for="i in pagination.navigatepageNums" @click="jumpByNumber(i)">
                            {{i}}
                        </a>
                        ]
                        <a href="#" :class="{disableHref:!pagination.hasNextPage}" @click="jump('next')">[ 下一页 ]</a>
                        <a href="#" :class="{disableHref:pagination.pageNum==pagination.lastPage}" @click="jump('last')">[ 末 页 ]</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>
<script>
    let data4Vue = {
        users: [],
        pagination: {},
    };
    let vue = new Vue({
       el: "#admin_app",
       data: data4Vue,
       mounted:function (){
            this.list(1);
       },
       methods:{
           list:function (start){
               let url = "users?start=" + start;
               axios.get(url).then(function (res){
                   vue.users = res.data.list;
                   vue.pagination = res.data;
               })
           },
           jump:function (page){
               if("first" === page && 1 != vue.pagination.pageNum) this.list(1);
               else if("pre" === page && vue.pagination.hasPreviousPage) this.list(vue.pagination.prePage);
               else if("next" === page && vue.pagination.hasNextPage) this.list(vue.pagination.nextPage);
               else if("last" === page && vue.pagination.pageNum != vue.pagination.pages) this.list(vue.pagination.pages);
           },
           jumpByNumber:function (start){
               this.list(start);
           },
       },
    });
</script>
</html>